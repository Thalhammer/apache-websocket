#
# Global Setup
#

Listen 59153
PidFile logs/httpd.pid

<IfModule !authn_core_module>
  LoadModule authn_core_module ${SYSTEM_MODULES_DIR}/mod_authn_core.so
</IfModule>
<IfModule !authz_core_module>
  LoadModule authz_core_module ${SYSTEM_MODULES_DIR}/mod_authz_core.so
</IfModule>
<IfModule !unixd_module>
  LoadModule unixd_module ${SYSTEM_MODULES_DIR}/mod_unixd.so
</IfModule>

LoadModule websocket_module modules/mod_websocket.so

DocumentRoot htdocs
<Directory htdocs>
  Require all granted
</Directory>

LogLevel websocket:debug

#
# Test Configuration
#

<Location /bad-config>
  SetHandler websocket-handler
</Location>

<Location /dumb-increment>
  SetHandler websocket-handler
  WebSocketHandler modules/mod_websocket_dumb_increment.so dumb_increment_init
</Location>

<Location /echo>
  SetHandler websocket-handler
  WebSocketHandler modules/mod_websocket_echo.so echo_init
</Location>

<Location /echo-allow-reserved>
  SetHandler websocket-handler
  WebSocketHandler modules/mod_websocket_echo.so echo_init
  WebSocketAllowReservedStatusCodes On
</Location>

<Location /no-origin-check>
  SetHandler websocket-handler
  WebSocketHandler modules/mod_websocket_echo.so echo_init
  WebSocketOriginCheck Off
</Location>

<Location /origin-whitelist>
  SetHandler websocket-handler
  WebSocketHandler modules/mod_websocket_echo.so echo_init

  WebSocketOriginCheck Trusted
  WebSocketTrustedOrigin http://origin-one https://origin-two:55
  WebSocketTrustedOrigin https://origin-three
</Location>
